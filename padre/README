To run PADRE, you must first obtain PRIMUS and ERSA results. Below is an example and the usage statement description.


Quick Start Example. Run PADRE on the ERSA and PRIMUS results.
This command will run PADRE on the example dataset and write the results to ../example_data/test.genome_PRIMUS/.

cd PADRE_dev/example_data/
../bin/run_PADRE.pl --ersa_model_output test_ERSA_models --ersa_results test_ERSA_results --project_summary test.genome_PRIMUS/Summary_test.genome.txt --degree_rel_cutoff 1

Usage:
    run_PADRE.pl [*options*] --ersa_model_output file --ersa_results file --project_summary file --degree_rel_cutoff <1|2|3> | -h

Options:
     For usage and documentation:
       -h, --help           Brief help message
       --man		     Full documentation
     Other options:
       -o, --output_dir     Specify path to the output directory for all results(default=[PATH_TO_IBD_FILE]_PRIMUS/)
       --ersa_model_output  Path to the model_output_file generated by ERSA
       --ersa_results       Path to the standard ERSA results file
       --project_summary    Path to the PRIMUS generated project level summary file (usualy in *_PRIMUS/ dir)
       --degree_rel_cutoff  Set the maximum degree of relatedness for two people to be considered related (default=3; i.e. 3rd degree relatives)



RESULTS DESCRIPTION
1. Network_connections.txt - This provides a description of how each network is most likely connected to every other network. There is a row for each pair of networks. The pedigree column contains the number of the pedigree that made the highest likelihood connection and the founder columns contain the ID of the founder that makes the most likely connection. The degree related column contains the most likely degree of relatedness between the two listed founders. The p-value column gives the p-value of that relationship. A p-value of nonsig means that it is not a signficant p-value. A p-value of "PRIMUS" means that relationship was determined by PRIMUS, and does not have a p-value.

2. Network_connections.dot - A .dot file that contains the graph of the network connections where each node is either a family network or a single individuals and the edges are relationships between the networks. The labels on the edges indicate the degree of relationships between the nodes. This file can be visualized with any graphing program that takes the .dot file format like Graphviz.

3. Sample_relatedness.txt - This file format is very similar to the Network_connections.txt file. While each row in the network_connections.txt file describe a pair of networks, each row in this file describe a pair of individuals. There is a line for each pair of individuals with the PADRE determined most-likely relationship.


WORKFLOW AND EXAMPLE COMMAND TO GET PADRE INPUT (see PADRE manuscipt for more details)
One you have genotypes or variant calls for your your dataset, you will need to do process the data in two parralel tracks to get ERSA results and PRIMUS results that will be input into PADRE.

1. ERSA workflow - genetic data -> phase (BEAGLE, SHAPEIT2, etc.) -> call IBD segments (GERMLINE, BEAGLE, etc.) -> ERSAv2.1 or newer
example commands from the PADRE manuscript:

GERMLINE's phasing pipeline: bash run.sh file.ped file.map out
GERMLINEv1.4.0: germline –homoz –err_het 1 –err_hom 2 –map [data_root_name_chrN].map –min_m 2.5 < [data_root_name_chrN_options].txt
ERSAv2.1: ersa --segment_files=[sample_data_germline.match_files] --model_output_file model_likelihoods.txt --output_file=ersa_results --confidence_level 0.999 --mask_common_shared_regions true --control_files=[CEU_germline.match_files]

2. PRIMUS workflow - genetic data -> estimate accurate genome-wide IBD proportions (PLINK, KING, prePRIMUS, etc.) -> PRIMUSv1.8 or newer

PLINKv1.9: plink --file [data_file_root_name] --genome --maf 0.05 --geno 0.1 --out [data_file_root_name]
PRIMUSv1.8: run_PRIMUS.pl --p [data_file_root_name].genome
